name: Build the Project
description: This action Build the project and upload it to the Artifactory.
inputs:
  upload_to_artifactory:
    description: 'Flag to control whether to upload to Artifactory'
    required: false
    default: 'false'

permissions: read-all
#Adding Permission as Read for all of the available permissions

runs:
  using: "composite"
  steps:
    - name: Run Build
      run: .\build\Build.bat
      shell: pwsh

    - name: Prepare files for upload
      run: |
        mkdir -p upload
        cp dist/* upload/
        cp -r AIDevKit upload/
        cp CHANGELOG.md upload/
        cp License.txt upload/
        cp README.md upload/
      shell: pwsh
    
    - name: Upload binary as artifact
      if: ${{ inputs.upload_to_artifactory == 'true' }}
      uses: actions/upload-artifact@v4
      with:
        name: ArtifactAIPC
        path: upload/